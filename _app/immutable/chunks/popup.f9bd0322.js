import{w as K}from"./index.7a9a3408.js";import{an as P}from"./index.bfb1ec04.js";const X=K(void 0);function G(o,e){const{computePosition:v,autoUpdate:j,offset:E,shift:h,flip:y,arrow:b,size:L,autoPlacement:$,hide:k,inline:x}=P(X),r={open:!1,autoUpdateCleanup:()=>{}},U=':is(a[href], button, input, textarea, select, details, [tabindex]):not([tabindex="-1"])';let w;const u="https://www.skeleton.dev/utilities/popups";let t,c;function F(){t=document.querySelector(`[data-popup="${e.target}"]`)??document.createElement("div"),c=(t==null?void 0:t.querySelector(".arrow"))??document.createElement("div")}F();function f(){var i,s,d,D,A,C,I,q;if(!t)throw new Error(`The data-popup="${e.target}" element was not found. ${u}`);if(!v)throw new Error(`Floating UI 'computePosition' not found for data-popup="${e.target}". ${u}`);if(!E)throw new Error(`Floating UI 'offset' not found for data-popup="${e.target}". ${u}`);if(!h)throw new Error(`Floating UI 'shift' not found for data-popup="${e.target}". ${u}`);if(!y)throw new Error(`Floating UI 'flip' not found for data-popup="${e.target}". ${u}`);if(!b)throw new Error(`Floating UI 'arrow' not found for data-popup="${e.target}". ${u}`);const n=[];L&&n.push(L((i=e.middleware)==null?void 0:i.size)),$&&n.push($((s=e.middleware)==null?void 0:s.autoPlacement)),k&&n.push(k((d=e.middleware)==null?void 0:d.hide)),x&&n.push(x((D=e.middleware)==null?void 0:D.inline)),v(o,t,{placement:e.placement??"bottom",middleware:[E(((A=e.middleware)==null?void 0:A.offset)??8),h(((C=e.middleware)==null?void 0:C.shift)??{padding:8}),y((I=e.middleware)==null?void 0:I.flip),b(((q=e.middleware)==null?void 0:q.arrow)??{element:c||null}),...n]}).then(({x:z,y:M,placement:O,middlewareData:W})=>{if(Object.assign(t.style,{left:`${z}px`,top:`${M}px`}),c){const{x:T,y:Q}=W.arrow,_={top:"bottom",right:"left",bottom:"top",left:"right"}[O.split("-")[0]];Object.assign(c.style,{left:T!=null?`${T}px`:"",top:Q!=null?`${Q}px`:"",right:"",bottom:"",[_]:"-4px"})}})}function l(){t&&(r.open=!0,e.state&&e.state({state:r.open}),f(),t.style.display="block",t.style.opacity="1",t.style.pointerEvents="auto",r.autoUpdateCleanup=j(o,t,f),w=Array.from(t==null?void 0:t.querySelectorAll(U)))}function a(n){if(!t)return;const i=parseFloat(window.getComputedStyle(t).transitionDuration.replace("s",""))*1e3;setTimeout(()=>{r.open=!1,e.state&&e.state({state:r.open}),t.style.opacity="0",t.style.pointerEvents="none",r.autoUpdateCleanup&&r.autoUpdateCleanup(),n&&n()},i)}function p(){r.open===!1?l():a()}function m(n){if(r.open===!1||o.contains(n.target))return;if(t&&t.contains(n.target)===!1){a();return}const i=e.closeQuery===void 0?"a[href], button":e.closeQuery,s=t==null?void 0:t.querySelectorAll(i);s==null||s.forEach(d=>{d.contains(n.target)&&a()})}const S=n=>{if(r.open===!1)return;const i=n.key;if(i==="Escape"){n.preventDefault(),o.focus(),a();return}r.open&&document.activeElement===o&&(i==="ArrowDown"||i==="Tab")&&U.length>0&&w.length>0&&(n.preventDefault(),w[0].focus())};switch(e.event){case"click":o.addEventListener("click",p,!0),window.addEventListener("click",m,!0);break;case"hover":o.addEventListener("mouseover",l,!0),o.addEventListener("mouseleave",()=>a(),!0);break;case"focus-blur":o.addEventListener("focus",p,!0),o.addEventListener("blur",()=>a(),!0);break;case"focus-click":o.addEventListener("focus",l,!0),window.addEventListener("click",m,!0);break;default:throw new Error(`Event value of '${e.event}' is not supported. ${u}`)}return window.addEventListener("keydown",S,!0),f(),{update(n){a(()=>{e=n,f(),F()})},destroy(){o.removeEventListener("click",p,!0),o.removeEventListener("mouseover",l,!0),o.removeEventListener("mouseleave",()=>a(),!0),o.removeEventListener("focus",p,!0),o.removeEventListener("focus",l,!0),o.removeEventListener("blur",()=>a(),!0),window.removeEventListener("click",m,!0),window.removeEventListener("keydown",S,!0)}}}export{G as p,X as s};

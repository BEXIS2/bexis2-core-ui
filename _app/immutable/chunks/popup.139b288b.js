import{w as B}from"./index.ff4efe22.js";import{am as K}from"./index.fc2521d4.js";const P=B(void 0);function G(o,e){const{computePosition:m,autoUpdate:j,offset:v,shift:E,flip:h,arrow:y,size:b,autoPlacement:L,hide:$,inline:k}=K(P);let r={open:!1,autoUpdateCleanup:()=>{}};const x=':is(a[href], button, input, textarea, select, details, [tabindex]):not([tabindex="-1"])';let U;const u="https://www.skeleton.dev/utilities/popups";let t,f;function F(){t=document.querySelector(`[data-popup="${e.target}"]`)??document.createElement("div"),f=(t==null?void 0:t.querySelector(".arrow"))??document.createElement("div")}F();function c(){var i,s,d,D,A,C,I,q;if(!t)throw new Error(`The data-popup="${e.target}" element was not found. ${u}`);if(!m)throw new Error(`Floating UI 'computePosition' not found for data-popup="${e.target}". ${u}`);if(!v)throw new Error(`Floating UI 'offset' not found for data-popup="${e.target}". ${u}`);if(!E)throw new Error(`Floating UI 'shift' not found for data-popup="${e.target}". ${u}`);if(!h)throw new Error(`Floating UI 'flip' not found for data-popup="${e.target}". ${u}`);if(!y)throw new Error(`Floating UI 'arrow' not found for data-popup="${e.target}". ${u}`);const n=[];b&&n.push(b((i=e.middleware)==null?void 0:i.size)),L&&n.push(L((s=e.middleware)==null?void 0:s.autoPlacement)),$&&n.push($((d=e.middleware)==null?void 0:d.hide)),k&&n.push(k((D=e.middleware)==null?void 0:D.inline)),m(o,t,{placement:e.placement??"bottom",middleware:[v(((A=e.middleware)==null?void 0:A.offset)??8),E(((C=e.middleware)==null?void 0:C.shift)??{padding:8}),h((I=e.middleware)==null?void 0:I.flip),y(((q=e.middleware)==null?void 0:q.arrow)??{element:f||null}),...n]}).then(({x:z,y:M,placement:O,middlewareData:W})=>{if(Object.assign(t.style,{left:`${z}px`,top:`${M}px`}),f){const{x:T,y:Q}=W.arrow,_={top:"bottom",right:"left",bottom:"top",left:"right"}[O.split("-")[0]];Object.assign(f.style,{left:T!=null?`${T}px`:"",top:Q!=null?`${Q}px`:"",right:"",bottom:"",[_]:"-4px"})}})}function l(){t&&(r.open=!0,e.state&&e.state({state:r.open}),c(),t.style.display="block",t.style.opacity="1",t.style.pointerEvents="auto",r.autoUpdateCleanup=j(o,t,c),U=Array.from(t==null?void 0:t.querySelectorAll(x)))}function a(n){if(!t)return;const i=parseFloat(window.getComputedStyle(t).transitionDuration.replace("s",""))*1e3;setTimeout(()=>{r.open=!1,e.state&&e.state({state:r.open}),t.style.opacity="0",t.style.pointerEvents="none",r.autoUpdateCleanup&&r.autoUpdateCleanup(),n&&n()},i)}function p(){r.open===!1?l():a()}function w(n){if(r.open===!1||o.contains(n.target))return;if(t&&t.contains(n.target)===!1){a();return}const i=e.closeQuery===void 0?"a[href], button":e.closeQuery,s=t==null?void 0:t.querySelectorAll(i);s==null||s.forEach(d=>{d.contains(n.target)&&a()})}const S=n=>{if(r.open===!1)return;const i=n.key;if(i==="Escape"){n.preventDefault(),o.focus(),a();return}r.open&&document.activeElement===o&&(i==="ArrowDown"||i==="Tab")&&(n.preventDefault(),x.length>0&&U[0].focus())};switch(e.event){case"click":o.addEventListener("click",p,!0),window.addEventListener("click",w,!0);break;case"hover":o.addEventListener("mouseover",l,!0),o.addEventListener("mouseleave",a,!0);break;case"focus-blur":o.addEventListener("focus",p,!0),o.addEventListener("blur",a,!0);break;case"focus-click":o.addEventListener("focus",l,!0),window.addEventListener("click",w,!0);break;default:throw new Error(`Event value of '${e.event}' is not supported. ${u}`)}return window.addEventListener("keydown",S,!0),c(),{update(n){a(()=>{e=n,c(),F()})},destroy(){o.removeEventListener("click",p,!0),o.removeEventListener("mouseover",l,!0),o.removeEventListener("mouseleave",a,!0),o.removeEventListener("focus",p,!0),o.removeEventListener("focus",l,!0),o.removeEventListener("blur",a,!0),window.removeEventListener("click",w,!0),window.removeEventListener("keydown",S,!0)}}}export{G as p,P as s};

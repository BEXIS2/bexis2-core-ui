function G(t){return t.split("-")[1]}function it(t){return t==="y"?"height":"width"}function B(t){return t.split("-")[0]}function I(t){return["top","bottom"].includes(B(t))?"x":"y"}function st(t,e,o){let{reference:n,floating:i}=t;const r=n.x+n.width/2-i.width/2,c=n.y+n.height/2-i.height/2,l=I(e),a=it(l),s=n[a]/2-i[a]/2,m=l==="x";let f;switch(B(e)){case"top":f={x:r,y:n.y-i.height};break;case"bottom":f={x:r,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:c};break;case"left":f={x:n.x-i.width,y:c};break;default:f={x:n.x,y:n.y}}switch(G(e)){case"start":f[l]-=s*(o&&m?-1:1);break;case"end":f[l]+=s*(o&&m?-1:1)}return f}const kt=async(t,e,o)=>{const{placement:n="bottom",strategy:i="absolute",middleware:r=[],platform:c}=o,l=r.filter(Boolean),a=await(c.isRTL==null?void 0:c.isRTL(e));let s=await c.getElementRects({reference:t,floating:e,strategy:i}),{x:m,y:f}=st(s,n,a),d=n,u={},h=0;for(let p=0;p<l.length;p++){const{name:g,fn:y}=l[p],{x,y:w,data:k,reset:b}=await y({x:m,y:f,initialPlacement:n,placement:d,strategy:i,middlewareData:u,rects:s,platform:c,elements:{reference:t,floating:e}});m=x??m,f=w??f,u={...u,[g]:{...u[g],...k}},b&&h<=50&&(h++,typeof b=="object"&&(b.placement&&(d=b.placement),b.rects&&(s=b.rects===!0?await c.getElementRects({reference:t,floating:e,strategy:i}):b.rects),{x:m,y:f}=st(s,d,a)),p=-1)}return{x:m,y:f,placement:d,strategy:i,middlewareData:u}};function ht(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function J(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function gt(t,e){var o;e===void 0&&(e={});const{x:n,y:i,platform:r,rects:c,elements:l,strategy:a}=t,{boundary:s="clippingAncestors",rootBoundary:m="viewport",elementContext:f="floating",altBoundary:d=!1,padding:u=0}=e,h=ht(u),p=l[d?f==="floating"?"reference":"floating":f],g=J(await r.getClippingRect({element:(o=await(r.isElement==null?void 0:r.isElement(p)))==null||o?p:p.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(l.floating)),boundary:s,rootBoundary:m,strategy:a})),y=f==="floating"?{...c.floating,x:n,y:i}:c.reference,x=await(r.getOffsetParent==null?void 0:r.getOffsetParent(l.floating)),w=await(r.isElement==null?void 0:r.isElement(x))&&await(r.getScale==null?void 0:r.getScale(x))||{x:1,y:1},k=J(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:x,strategy:a}):y);return{top:(g.top-k.top+h.top)/w.y,bottom:(k.bottom-g.bottom+h.bottom)/w.y,left:(g.left-k.left+h.left)/w.x,right:(k.right-g.right+h.right)/w.x}}const Dt=Math.min,St=Math.max;function nt(t,e,o){return St(t,Dt(e,o))}const Mt=t=>({name:"arrow",options:t,async fn(e){const{element:o,padding:n=0}=t||{},{x:i,y:r,placement:c,rects:l,platform:a,elements:s}=e;if(o==null)return{};const m=ht(n),f={x:i,y:r},d=I(c),u=it(d),h=await a.getDimensions(o),p=d==="y",g=p?"top":"left",y=p?"bottom":"right",x=p?"clientHeight":"clientWidth",w=l.reference[u]+l.reference[d]-f[d]-l.floating[u],k=f[d]-l.reference[d],b=await(a.getOffsetParent==null?void 0:a.getOffsetParent(o));let S=b?b[x]:0;S&&await(a.isElement==null?void 0:a.isElement(b))||(S=s.floating[x]||l.floating[u]);const H=w/2-k/2,W=m[g],X=S-h[u]-m[y],D=S/2-h[u]/2+H,v=nt(W,D,X),T=G(c)!=null&&D!=v&&l.reference[u]/2-(D<W?m[g]:m[y])-h[u]/2<0;return{[d]:f[d]-(T?D<W?W-D:X-D:0),data:{[d]:v,centerOffset:D-v}}}}),Pt=["top","right","bottom","left"];Pt.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]);const Ct={left:"right",right:"left",bottom:"top",top:"bottom"};function K(t){return t.replace(/left|right|bottom|top/g,e=>Ct[e])}function Ft(t,e,o){o===void 0&&(o=!1);const n=G(t),i=I(t),r=it(i);let c=i==="x"?n===(o?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[r]>e.floating[r]&&(c=K(c)),{main:c,cross:K(c)}}const Ot={start:"end",end:"start"};function et(t){return t.replace(/start|end/g,e=>Ot[e])}const zt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var o;const{placement:n,middlewareData:i,rects:r,initialPlacement:c,platform:l,elements:a}=e,{mainAxis:s=!0,crossAxis:m=!0,fallbackPlacements:f,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:h=!0,...p}=t,g=B(n),y=B(c)===c,x=await(l.isRTL==null?void 0:l.isRTL(a.floating)),w=f||(y||!h?[K(c)]:function(v){const T=K(v);return[et(v),T,et(T)]}(c));f||u==="none"||w.push(...function(v,T,V,C){const P=G(v);let E=function(Y,tt,Tt){const lt=["left","right"],ct=["right","left"],At=["top","bottom"],$t=["bottom","top"];switch(Y){case"top":case"bottom":return Tt?tt?ct:lt:tt?lt:ct;case"left":case"right":return tt?At:$t;default:return[]}}(B(v),V==="start",C);return P&&(E=E.map(Y=>Y+"-"+P),T&&(E=E.concat(E.map(et)))),E}(c,h,u,x));const k=[c,...w],b=await gt(e,p),S=[];let H=((o=i.flip)==null?void 0:o.overflows)||[];if(s&&S.push(b[g]),m){const{main:v,cross:T}=Ft(n,r,x);S.push(b[v],b[T])}if(H=[...H,{placement:n,overflows:S}],!S.every(v=>v<=0)){var W,X;const v=(((W=i.flip)==null?void 0:W.index)||0)+1,T=k[v];if(T)return{data:{index:v,overflows:H},reset:{placement:T}};let V=(X=H.filter(C=>C.overflows[0]<=0).sort((C,P)=>C.overflows[1]-P.overflows[1])[0])==null?void 0:X.placement;if(!V)switch(d){case"bestFit":{var D;const C=(D=H.map(P=>[P.placement,P.overflows.filter(E=>E>0).reduce((E,Y)=>E+Y,0)]).sort((P,E)=>P[1]-E[1])[0])==null?void 0:D[0];C&&(V=C);break}case"initialPlacement":V=c}if(n!==V)return{reset:{placement:V}}}return{}}}},Nt=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:o,y:n}=e,i=await async function(r,c){const{placement:l,platform:a,elements:s}=r,m=await(a.isRTL==null?void 0:a.isRTL(s.floating)),f=B(l),d=G(l),u=I(l)==="x",h=["left","top"].includes(f)?-1:1,p=m&&u?-1:1,g=typeof c=="function"?c(r):c;let{mainAxis:y,crossAxis:x,alignmentAxis:w}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...g};return d&&typeof w=="number"&&(x=d==="end"?-1*w:w),u?{x:x*p,y:y*h}:{x:y*h,y:x*p}}(e,t);return{x:o+i.x,y:n+i.y,data:i}}}};function Ht(t){return t==="x"?"y":"x"}const Xt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:o,y:n,placement:i}=e,{mainAxis:r=!0,crossAxis:c=!1,limiter:l={fn:g=>{let{x:y,y:x}=g;return{x:y,y:x}}},...a}=t,s={x:o,y:n},m=await gt(e,a),f=I(B(i)),d=Ht(f);let u=s[f],h=s[d];if(r){const g=f==="y"?"bottom":"right";u=nt(u+m[f==="y"?"top":"left"],u,u-m[g])}if(c){const g=d==="y"?"bottom":"right";h=nt(h+m[d==="y"?"top":"left"],h,h-m[g])}const p=l.fn({...e,[f]:u,[d]:h});return{...p,data:{x:p.x-o,y:p.y-n}}}}};function L(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function A(t){return L(t).getComputedStyle(t)}function yt(t){return t instanceof L(t).Node}function O(t){return yt(t)?(t.nodeName||"").toLowerCase():""}function $(t){return t instanceof L(t).HTMLElement}function R(t){return t instanceof L(t).Element}function at(t){return typeof ShadowRoot>"u"?!1:t instanceof L(t).ShadowRoot||t instanceof ShadowRoot}function q(t){const{overflow:e,overflowX:o,overflowY:n,display:i}=A(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+o)&&!["inline","contents"].includes(i)}function Wt(t){return["table","td","th"].includes(O(t))}function ot(t){const e=rt(),o=A(t);return o.transform!=="none"||o.perspective!=="none"||!e&&!!o.backdropFilter&&o.backdropFilter!=="none"||!e&&!!o.filter&&o.filter!=="none"||["transform","perspective","filter"].some(n=>(o.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(o.contain||"").includes(n))}function rt(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function U(t){return["html","body","#document"].includes(O(t))}const ft=Math.min,_=Math.max,Q=Math.round;function xt(t){const e=A(t);let o=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=$(t),r=i?t.offsetWidth:o,c=i?t.offsetHeight:n,l=Q(o)!==r||Q(n)!==c;return l&&(o=r,n=c),{width:o,height:n,fallback:l}}function wt(t){return R(t)?t:t.contextElement}const vt={x:1,y:1};function z(t){const e=wt(t);if(!$(e))return vt;const o=e.getBoundingClientRect(),{width:n,height:i,fallback:r}=xt(e);let c=(r?Q(o.width):o.width)/n,l=(r?Q(o.height):o.height)/i;return c&&Number.isFinite(c)||(c=1),l&&Number.isFinite(l)||(l=1),{x:c,y:l}}const ut={x:0,y:0};function bt(t,e,o){var n,i;if(e===void 0&&(e=!0),!rt())return ut;const r=t?L(t):window;return!o||e&&o!==r?ut:{x:((n=r.visualViewport)==null?void 0:n.offsetLeft)||0,y:((i=r.visualViewport)==null?void 0:i.offsetTop)||0}}function M(t,e,o,n){e===void 0&&(e=!1),o===void 0&&(o=!1);const i=t.getBoundingClientRect(),r=wt(t);let c=vt;e&&(n?R(n)&&(c=z(n)):c=z(t));const l=bt(r,o,n);let a=(i.left+l.x)/c.x,s=(i.top+l.y)/c.y,m=i.width/c.x,f=i.height/c.y;if(r){const d=L(r),u=n&&R(n)?L(n):n;let h=d.frameElement;for(;h&&n&&u!==d;){const p=z(h),g=h.getBoundingClientRect(),y=getComputedStyle(h);g.x+=(h.clientLeft+parseFloat(y.paddingLeft))*p.x,g.y+=(h.clientTop+parseFloat(y.paddingTop))*p.y,a*=p.x,s*=p.y,m*=p.x,f*=p.y,a+=g.x,s+=g.y,h=L(h).frameElement}}return J({width:m,height:f,x:a,y:s})}function F(t){return((yt(t)?t.ownerDocument:t.document)||window.document).documentElement}function Z(t){return R(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Rt(t){return M(F(t)).left+Z(t).scrollLeft}function N(t){if(O(t)==="html")return t;const e=t.assignedSlot||t.parentNode||at(t)&&t.host||F(t);return at(e)?e.host:e}function Et(t){const e=N(t);return U(e)?e.ownerDocument.body:$(e)&&q(e)?e:Et(e)}function j(t,e){var o;e===void 0&&(e=[]);const n=Et(t),i=n===((o=t.ownerDocument)==null?void 0:o.body),r=L(n);return i?e.concat(r,r.visualViewport||[],q(n)?n:[]):e.concat(n,j(n))}function dt(t,e,o){let n;if(e==="viewport")n=function(i,r){const c=L(i),l=F(i),a=c.visualViewport;let s=l.clientWidth,m=l.clientHeight,f=0,d=0;if(a){s=a.width,m=a.height;const u=rt();(!u||u&&r==="fixed")&&(f=a.offsetLeft,d=a.offsetTop)}return{width:s,height:m,x:f,y:d}}(t,o);else if(e==="document")n=function(i){const r=F(i),c=Z(i),l=i.ownerDocument.body,a=_(r.scrollWidth,r.clientWidth,l.scrollWidth,l.clientWidth),s=_(r.scrollHeight,r.clientHeight,l.scrollHeight,l.clientHeight);let m=-c.scrollLeft+Rt(i);const f=-c.scrollTop;return A(l).direction==="rtl"&&(m+=_(r.clientWidth,l.clientWidth)-a),{width:a,height:s,x:m,y:f}}(F(t));else if(R(e))n=function(i,r){const c=M(i,!0,r==="fixed"),l=c.top+i.clientTop,a=c.left+i.clientLeft,s=$(i)?z(i):{x:1,y:1};return{width:i.clientWidth*s.x,height:i.clientHeight*s.y,x:a*s.x,y:l*s.y}}(e,o);else{const i=bt(t);n={...e,x:e.x-i.x,y:e.y-i.y}}return J(n)}function Lt(t,e){const o=N(t);return!(o===e||!R(o)||U(o))&&(A(o).position==="fixed"||Lt(o,e))}function mt(t,e){return $(t)&&A(t).position!=="fixed"?e?e(t):t.offsetParent:null}function pt(t,e){const o=L(t);if(!$(t))return o;let n=mt(t,e);for(;n&&Wt(n)&&A(n).position==="static";)n=mt(n,e);return n&&(O(n)==="html"||O(n)==="body"&&A(n).position==="static"&&!ot(n))?o:n||function(i){let r=N(i);for(;$(r)&&!U(r);){if(ot(r))return r;r=N(r)}return null}(t)||o}function Vt(t,e,o){const n=$(e),i=F(e),r=o==="fixed",c=M(t,!0,r,e);let l={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(n||!n&&!r)if((O(e)!=="body"||q(i))&&(l=Z(e)),$(e)){const s=M(e,!0,r,e);a.x=s.x+e.clientLeft,a.y=s.y+e.clientTop}else i&&(a.x=Rt(i));return{x:c.left+l.scrollLeft-a.x,y:c.top+l.scrollTop-a.y,width:c.width,height:c.height}}const Bt={getClippingRect:function(t){let{element:e,boundary:o,rootBoundary:n,strategy:i}=t;const r=o==="clippingAncestors"?function(s,m){const f=m.get(s);if(f)return f;let d=j(s).filter(g=>R(g)&&O(g)!=="body"),u=null;const h=A(s).position==="fixed";let p=h?N(s):s;for(;R(p)&&!U(p);){const g=A(p),y=ot(p);y||g.position!=="fixed"||(u=null),(h?!y&&!u:!y&&g.position==="static"&&u&&["absolute","fixed"].includes(u.position)||q(p)&&!y&&Lt(s,p))?d=d.filter(x=>x!==p):u=g,p=N(p)}return m.set(s,d),d}(e,this._c):[].concat(o),c=[...r,n],l=c[0],a=c.reduce((s,m)=>{const f=dt(e,m,i);return s.top=_(f.top,s.top),s.right=ft(f.right,s.right),s.bottom=ft(f.bottom,s.bottom),s.left=_(f.left,s.left),s},dt(e,l,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:o,strategy:n}=t;const i=$(o),r=F(o);if(o===r)return e;let c={scrollLeft:0,scrollTop:0},l={x:1,y:1};const a={x:0,y:0};if((i||!i&&n!=="fixed")&&((O(o)!=="body"||q(r))&&(c=Z(o)),$(o))){const s=M(o);l=z(o),a.x=s.x+o.clientLeft,a.y=s.y+o.clientTop}return{width:e.width*l.x,height:e.height*l.y,x:e.x*l.x-c.scrollLeft*l.x+a.x,y:e.y*l.y-c.scrollTop*l.y+a.y}},isElement:R,getDimensions:function(t){return xt(t)},getOffsetParent:pt,getDocumentElement:F,getScale:z,async getElementRects(t){let{reference:e,floating:o,strategy:n}=t;const i=this.getOffsetParent||pt,r=this.getDimensions;return{reference:Vt(e,await i(o),n),floating:{x:0,y:0,...await r(o)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>A(t).direction==="rtl"};function Yt(t,e,o,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:r=!0,elementResize:c=!0,animationFrame:l=!1}=n,a=i||r?[...R(t)?j(t):t.contextElement?j(t.contextElement):[],...j(e)]:[];a.forEach(d=>{const u=!R(d)&&d.toString().includes("V");!i||l&&!u||d.addEventListener("scroll",o,{passive:!0}),r&&d.addEventListener("resize",o)});let s,m=null;c&&(m=new ResizeObserver(()=>{o()}),R(t)&&!l&&m.observe(t),R(t)||!t.contextElement||l||m.observe(t.contextElement),m.observe(e));let f=l?M(t):null;return l&&function d(){const u=M(t);!f||u.x===f.x&&u.y===f.y&&u.width===f.width&&u.height===f.height||o(),f=u,s=requestAnimationFrame(d)}(),o(),()=>{var d;a.forEach(u=>{i&&u.removeEventListener("scroll",o),r&&u.removeEventListener("resize",o)}),(d=m)==null||d.disconnect(),m=null,l&&cancelAnimationFrame(s)}}const _t=(t,e,o)=>{const n=new Map,i={platform:Bt,...o},r={...i.platform,_c:n};return kt(t,e,{...i,platform:r})};export{Nt as D,_t as M,zt as b,Xt as k,Mt as u,Yt as z};

import{w as x}from"./index.d2b23aab.js";import{ao as J}from"./index.3bdb7440.js";const G=x(void 0),K=x(void 0);function R(e,t){const{computePosition:s,autoUpdate:w,offset:m,shift:v,flip:c,arrow:p,size:E,autoPlacement:a,hide:l,inline:h}=J(K);let r={open:!1,autoUpdateCleanup:()=>{}};const C=':is(a[href], button, input, textarea, select, details, [tabindex]):not([tabindex="-1"])';let D;const f="https://www.skeleton.dev/utilities/popups";let n,b;function I(){n=document.querySelector(`[data-popup="${t.target}"]`)??document.createElement("div"),b=(n==null?void 0:n.querySelector(".arrow"))??document.createElement("div")}I();function L(){var i,d,S,A,T,q,z,O;if(!n)throw new Error(`The data-popup="${t.target}" element was not found. ${f}`);if(!s)throw new Error(`Floating UI 'computePosition' not found for data-popup="${t.target}". ${f}`);if(!m)throw new Error(`Floating UI 'offset' not found for data-popup="${t.target}". ${f}`);if(!v)throw new Error(`Floating UI 'shift' not found for data-popup="${t.target}". ${f}`);if(!c)throw new Error(`Floating UI 'flip' not found for data-popup="${t.target}". ${f}`);if(!p)throw new Error(`Floating UI 'arrow' not found for data-popup="${t.target}". ${f}`);const o=[];E&&o.push(E((i=t.middleware)==null?void 0:i.size)),a&&o.push(a((d=t.middleware)==null?void 0:d.autoPlacement)),l&&o.push(l((S=t.middleware)==null?void 0:S.hide)),h&&o.push(h((A=t.middleware)==null?void 0:A.inline)),s(e,n,{placement:t.placement??"bottom",middleware:[m(((T=t.middleware)==null?void 0:T.offset)??8),v(((q=t.middleware)==null?void 0:q.shift)??{padding:8}),c((z=t.middleware)==null?void 0:z.flip),p(((O=t.middleware)==null?void 0:O.arrow)??{element:b||null}),...o]}).then(({x:M,y:V,placement:W,middlewareData:B})=>{if(Object.assign(n.style,{left:`${M}px`,top:`${V}px`}),b){const{x:P,y:j}=B.arrow,H={top:"bottom",right:"left",bottom:"top",left:"right"}[W.split("-")[0]];Object.assign(b.style,{left:P!=null?`${P}px`:"",top:j!=null?`${j}px`:"",right:"",bottom:"",[H]:"-4px"})}})}function y(){n&&(r.open=!0,t.state&&t.state({state:r.open}),L(),n.style.display="block",n.style.opacity="1",n.style.pointerEvents="auto",r.autoUpdateCleanup=w(e,n,L),D=Array.from(n==null?void 0:n.querySelectorAll(C)))}function u(o){if(!n)return;const i=parseFloat(window.getComputedStyle(n).transitionDuration.replace("s",""))*1e3;setTimeout(()=>{r.open=!1,t.state&&t.state({state:r.open}),n.style.opacity="0",n.style.pointerEvents="none",r.autoUpdateCleanup&&r.autoUpdateCleanup(),o&&o()},i)}function $(){r.open===!1?y():u()}function k(o){if(r.open===!1||e.contains(o.target))return;if(n&&n.contains(o.target)===!1){u();return}const i=t.closeQuery===void 0?"a[href], button":t.closeQuery,d=n==null?void 0:n.querySelectorAll(i);d==null||d.forEach(S=>{S.contains(o.target)&&u()})}const _=o=>{if(r.open===!1)return;const i=o.key;if(i==="Escape"){o.preventDefault(),e.focus(),u();return}r.open&&document.activeElement===e&&(i==="ArrowDown"||i==="Tab")&&(o.preventDefault(),C.length>0&&D[0].focus())};switch(t.event){case"click":e.addEventListener("click",$,!0),window.addEventListener("click",k,!0);break;case"hover":e.addEventListener("mouseover",y,!0),e.addEventListener("mouseleave",u,!0);break;case"focus-blur":e.addEventListener("focus",$,!0),e.addEventListener("blur",u,!0);break;case"focus-click":e.addEventListener("focus",y,!0),window.addEventListener("click",k,!0);break;default:throw new Error(`Event value of '${t.event}' is not supported. ${f}`)}return window.addEventListener("keydown",_,!0),L(),{update(o){u(()=>{t=o,L(),I()})},destroy(){e.removeEventListener("click",$,!0),e.removeEventListener("mouseover",y,!0),e.removeEventListener("mouseleave",u,!0),e.removeEventListener("focus",$,!0),e.removeEventListener("focus",y,!0),e.removeEventListener("blur",u,!0),window.removeEventListener("click",k,!0),window.removeEventListener("keydown",_,!0)}}}const U={};function Q(e){return e==="local"?localStorage:sessionStorage}function F(e,t,s){const w=(s==null?void 0:s.serializer)??JSON,m=(s==null?void 0:s.storage)??"local";function v(c,p){Q(m).setItem(c,w.stringify(p))}if(!U[e]){const c=x(t,a=>{const l=Q(m).getItem(e);l&&a(w.parse(l));{const h=r=>{r.key===e&&a(r.newValue?w.parse(r.newValue):null)};return window.addEventListener("storage",h),()=>window.removeEventListener("storage",h)}}),{subscribe:p,set:E}=c;U[e]={set(a){v(e,a),E(a)},update(a){const l=a(J(c));v(e,l),E(l)},subscribe:p}}return U[e]}F("modeOsPrefers",!1);F("modeUserPrefers",void 0);F("modeCurrent",!1);export{G as a,R as p,K as s};
